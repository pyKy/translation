<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Touch Tracer Line Drawing Demonstration &mdash; kivy-intro-jp 1.0 ドキュメント</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="kivy-intro-jp 1.0 ドキュメント" href="../index.html" />
    <link rel="up" title="実例集(Gallery of Examples)" href="index.html" />
    <link rel="next" title="ユーザーガイド(User’s Guide)" href="../users_guide/index.html" />
    <link rel="prev" title="Showcase of Kivy Features" href="gen__demo__showcase__main__py.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Kivy Japanese Translation</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">入門(Getting Started)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">実例集(Gallery of Examples)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html">ユーザーガイド(User’s Guide)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming_guide/index.html">プログラミングガイド(Programming Guide)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">チュートリアル(Tutorial)</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page Contents <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Touch Tracer Line Drawing Demonstration</a><ul>
<li><a class="reference internal" href="#demo-touchtracer-main-py">demo/touchtracer/main.py ファイル</a></li>
<li><a class="reference internal" href="#demo-showcase-data-background-png">demo/showcase/data/background.png</a></li>
<li><a class="reference internal" href="#demo-touchtracer-touchtracer-kv">demo/touchtracer/touchtracer.kv ファイル</a></li>
<li><a class="reference internal" href="#demo-showcase-android-txt">demo/showcase/android.txt ファイル</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="gen__demo__showcase__main__py.html" title="Previous Chapter: Showcase of Kivy Features"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Showcase of K...</span>
    </a>
  </li>
  <li>
    <a href="../users_guide/index.html" title="Next Chapter: ユーザーガイド(User’s Guide)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ユーザーガイド(User’... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">入門(Getting Started)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/introduction.html">導入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">インストール</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#id2">開発バージョン</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/first_app.html">概要</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/properties.html">入門</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/event.html">イベント</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/Non-widget_stuff.html">Non-widget stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/layouts.html">導入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/drawing.html">入門</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">実例集(Gallery of Examples)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__3Drendering__main__py.html">3Dのサルの頭を回転する</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__animation__animate__py.html">ウィジェットアニメーション</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__application__app_suite__py.html">Suite of Application Builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__application__app_with_build__py.html">build() と return を使用したアプリケーションの例</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__application__app_with_kv_in_template1__py.html">Application from a .kv in a Template Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__application__app_with_kv__py.html">アプリケーションを.kv fileからビルドする</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__camera__main__py.html">Gallery of Examples » Camera Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__bezier__py.html">Bezier Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__canvas_stress__py.html">Canvas stress</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__circle__py.html">Circle Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__fbo_canvas__py.html">FBO Canvas</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__lines_extended__py.html">Lines Extended Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__lines__py.html">Line (SmoothLine) Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__mesh__py.html">Mesh test</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__multitexture__py.html">Multitexture Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__repeat_texture__py.html">Repeat Texture on Resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__rotation__py.html">Rotation Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__stencil_canvas__py.html">Stencil demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__tesselate__py.html">Tesselate Demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__canvas__texture__py.html">Texture Wrapping and Coordinates Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__camera_puzzle__py..html">Shuffled Camera Feed Puzzle</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__kivycatalog__main__py.html">Kivy Catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__multistroke__main__py.html">Multistroke Recognition Database Demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__pictures__main__py.html">Basic Picture Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__shadereditor__main__py.html">Live Shader Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen__demo__showcase__main__py.html">Showcase of Kivy Features</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Touch Tracer Line Drawing Demonstration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html">ユーザーガイド(User’s Guide)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../users_guide/philosophy.html">フィロソフィ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../programming_guide/index.html">プログラミングガイド(Programming Guide)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../programming_guide/basic.html">Kivyの基礎</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming_guide/basic.html#id2">アプリケーションを作る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming_guide/architectural_overview.html">構造的概要</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming_guide/packaging-windows.html">Widowsでのパッケージの方法</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">チュートリアル(Tutorial)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/pong_game_tutorial.html">ポンゲームチューtリアル</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/simple_paint_app.html">シンプルなペイントアプリケーション</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="touch-tracer-line-drawing-demonstration">
<h1>Touch Tracer Line Drawing Demonstration<a class="headerlink" href="#touch-tracer-line-drawing-demonstration" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>このドキュメンテーションはGallery of Examples » Touch Tracer Line Drawing Demonstrationを日本語訳したものです。
<a class="reference external" href="https://kivy.org/docs/examples/gen__demo__touchtracer__main__py.html">https://kivy.org/docs/examples/gen__demo__touchtracer__main__py.html</a></p>
<img alt="https://kivy.org/docs/_images/demo__touchtracer__main__py1.png" src="https://kivy.org/docs/_images/demo__touchtracer__main__py1.png" />
<p>デバイスに登録された各タッチを追跡するデモです。
基本的な背景画像が表示されます。
マウスを押して保持する場合、マウスの座標を持つ十字線が表示されます。
ドラッグすると、それは軌跡を残します。
touch.profileに使用してデバイス情報がある場合は、圧力と同様に追加情報として表示されます。
プログラムは、Appサブクラスのアイコンにicon.pngファイルを指定します。
また、白い透明の軌跡を描画するためのソースとしてparticle.pngファイルを使用しています。
touchtracer.kvファイルは、アプリケーションを記述しています。
android.txtファイルはKivyランチャーAndroi dのアプリケーションで使用するためのアプリケーションをパッケージ化するために使用されます。
Androidデバイスでは、デバイス上の/sdcard/kivy/touchtracer にこのディレクトリをコピー/ペーストします。</p>
<div class="section" id="demo-touchtracer-main-py">
<h2>demo/touchtracer/main.py ファイル<a class="headerlink" href="#demo-touchtracer-main-py" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>&#8216;&#8217;&#8217;
Touch Tracer Line Drawing Demonstration
=======================================</p>
<p>This demonstrates tracking each touch registered to a device. You should
see a basic background image. When you press and hold the mouse, you
should see cross-hairs with the coordinates written next to them. As
you drag, it leaves a trail. Additional information, like pressure,
will be shown if they are in your device&#8217;s touch.profile.</p>
<p>This program specifies an icon, the file icon.png, in its App subclass.
It also uses the particle.png file as the source for drawing the trails which
are white on transparent. The file touchtracer.kv describes the application.</p>
<p>The file android.txt is used to package the application for use with the
Kivy Launcher Android application. For Android devices, you can
copy/paste this directory into /sdcard/kivy/touchtracer on your Android device.</p>
<p>&#8216;&#8217;&#8217;
__version__ = &#8216;1.0&#8217;</p>
<p>import kivy
kivy.require(&#8216;1.0.6&#8217;)</p>
<p>from kivy.app import App
from kivy.uix.floatlayout import FloatLayout
from kivy.uix.label import Label
from kivy.graphics import Color, Rectangle, Point, GraphicException
from random import random
from math import sqrt</p>
<dl class="docutils">
<dt>def calculate_points(x1, y1, x2, y2, steps=5):</dt>
<dd><p class="first">dx = x2 - x1
dy = y2 - y1
dist = sqrt(dx * dx + dy * dy)
if dist &lt; steps:</p>
<blockquote>
<div>return None</div></blockquote>
<p>o = []
m = dist / steps
for i in range(1, int(m)):</p>
<blockquote>
<div>mi = i / m
lastx = x1 + dx * mi
lasty = y1 + dy * mi
o.extend([lastx, lasty])</div></blockquote>
<p class="last">return o</p>
</dd>
</dl>
<p>class Touchtracer(FloatLayout):</p>
<blockquote>
<div><dl class="docutils">
<dt>def on_touch_down(self, touch):</dt>
<dd><p class="first">win = self.get_parent_window()
ud = touch.ud
ud[&#8216;group&#8217;] = g = str(touch.uid)
pointsize = 5
if &#8216;pressure&#8217; in touch.profile:</p>
<blockquote>
<div>ud[&#8216;pressure&#8217;] = touch.pressure
pointsize = (touch.pressure * 100000) ** 2</div></blockquote>
<p>ud[&#8216;color&#8217;] = random()</p>
<dl class="docutils">
<dt>with self.canvas:</dt>
<dd><p class="first">Color(ud[&#8216;color&#8217;], 1, 1, mode=&#8217;hsv&#8217;, group=g)
ud[&#8216;lines&#8217;] = [</p>
<blockquote class="last">
<div><p>Rectangle(pos=(touch.x, 0), size=(1, win.height), group=g),
Rectangle(pos=(0, touch.y), size=(win.width, 1), group=g),
Point(points=(touch.x, touch.y), source=&#8217;particle.png&#8217;,</p>
<blockquote>
<div>pointsize=pointsize, group=g)]</div></blockquote>
</div></blockquote>
</dd>
</dl>
<p class="last">ud[&#8216;label&#8217;] = Label(size_hint=(None, None))
self.update_touch_label(ud[&#8216;label&#8217;], touch)
self.add_widget(ud[&#8216;label&#8217;])
touch.grab(self)
return True</p>
</dd>
<dt>def on_touch_move(self, touch):</dt>
<dd><dl class="first docutils">
<dt>if touch.grab_current is not self:</dt>
<dd>return</dd>
</dl>
<p>ud = touch.ud
ud[&#8216;lines&#8217;][0].pos = touch.x, 0
ud[&#8216;lines&#8217;][1].pos = 0, touch.y</p>
<p>index = -1</p>
<dl class="docutils">
<dt>while True:</dt>
<dd><dl class="first last docutils">
<dt>try:</dt>
<dd>points = ud[&#8216;lines&#8217;][index].points
oldx, oldy = points[-2], points[-1]
break</dd>
<dt>except:</dt>
<dd>index -= 1</dd>
</dl>
</dd>
</dl>
<p>points = calculate_points(oldx, oldy, touch.x, touch.y)</p>
<p># if pressure changed create a new point instruction
if &#8216;pressure&#8217; in ud:</p>
<blockquote>
<div><dl class="docutils">
<dt>if not .95 &lt; (touch.pressure / ud[&#8216;pressure&#8217;]) &lt; 1.05:</dt>
<dd><p class="first">g = ud[&#8216;group&#8217;]
pointsize = (touch.pressure * 100000) ** 2
with self.canvas:</p>
<blockquote class="last">
<div><p>Color(ud[&#8216;color&#8217;], 1, 1, mode=&#8217;hsv&#8217;, group=g)
ud[&#8216;lines&#8217;].append(</p>
<blockquote>
<div><dl class="docutils">
<dt>Point(points=(), source=&#8217;particle.png&#8217;,</dt>
<dd>pointsize=pointsize, group=g))</dd>
</dl>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>if points:</dt>
<dd><dl class="first last docutils">
<dt>try:</dt>
<dd><p class="first">lp = ud[&#8216;lines&#8217;][-1].add_point
for idx in range(0, len(points), 2):</p>
<blockquote class="last">
<div>lp(points[idx], points[idx + 1])</div></blockquote>
</dd>
<dt>except GraphicException:</dt>
<dd>pass</dd>
</dl>
</dd>
</dl>
<p>ud[&#8216;label&#8217;].pos = touch.pos
import time
t = int(time.time())
if t not in ud:</p>
<blockquote>
<div>ud[t] = 1</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>ud[t] += 1</dd>
</dl>
<p class="last">self.update_touch_label(ud[&#8216;label&#8217;], touch)</p>
</dd>
<dt>def on_touch_up(self, touch):</dt>
<dd><dl class="first docutils">
<dt>if touch.grab_current is not self:</dt>
<dd>return</dd>
</dl>
<p class="last">touch.ungrab(self)
ud = touch.ud
self.canvas.remove_group(ud[&#8216;group&#8217;])
self.remove_widget(ud[&#8216;label&#8217;])</p>
</dd>
<dt>def update_touch_label(self, label, touch):</dt>
<dd><dl class="first docutils">
<dt>label.text = &#8216;ID: %snPos: (%d, %d)nClass: %s&#8217; % (</dt>
<dd>touch.id, touch.x, touch.y, touch.__class__.__name__)</dd>
</dl>
<p class="last">label.texture_update()
label.pos = touch.pos
label.size = label.texture_size[0] + 20, label.texture_size[1] + 20</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>class TouchtracerApp(App):</dt>
<dd><p class="first">title = &#8216;Touchtracer&#8217;
icon = &#8216;icon.png&#8217;</p>
<dl class="last docutils">
<dt>def build(self):</dt>
<dd>return Touchtracer()</dd>
<dt>def on_pause(self):</dt>
<dd>return True</dd>
</dl>
</dd>
<dt>if __name__ == &#8216;__main__&#8217;:</dt>
<dd>TouchtracerApp().run()</dd>
</dl>
</div>
<div class="section" id="demo-showcase-data-background-png">
<h2>demo/showcase/data/background.png<a class="headerlink" href="#demo-showcase-data-background-png" title="このヘッドラインへのパーマリンク">¶</a></h2>
</div>
<div class="section" id="demo-touchtracer-touchtracer-kv">
<h2>demo/touchtracer/touchtracer.kv ファイル<a class="headerlink" href="#demo-touchtracer-touchtracer-kv" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>#:kivy 1.0
#:import kivy kivy</p>
<dl class="docutils">
<dt>&lt;Touchtracer&gt;:</dt>
<dd><dl class="first last docutils">
<dt>canvas:</dt>
<dd><dl class="first last docutils">
<dt>Color:</dt>
<dd>rgb: 1, 1, 1</dd>
<dt>Rectangle:</dt>
<dd>source: &#8216;data/images/background.jpg&#8217;
size: self.size</dd>
</dl>
</dd>
<dt>BoxLayout:</dt>
<dd><p class="first">padding: &#8216;10dp&#8217;
spacing: &#8216;10dp&#8217;
size_hint: 1, None
pos_hint: {&#8216;top&#8217;: 1}
height: &#8216;44dp&#8217;
Image:</p>
<blockquote>
<div>size_hint: None, None
size: &#8216;24dp&#8217;, &#8216;24dp&#8217;
source: &#8216;data/logo/kivy-icon-64.png&#8217;
mipmap: True</div></blockquote>
<dl class="last docutils">
<dt>Label:</dt>
<dd>height: &#8216;24dp&#8217;
text_size: self.width, None
color: (1, 1, 1, .8)
text: &#8216;Kivy %s - Touchtracer&#8217; % kivy.__version__
valign: &#8216;middle&#8217;</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="demo-showcase-android-txt">
<h2>demo/showcase/android.txt ファイル<a class="headerlink" href="#demo-showcase-android-txt" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>title=Showcase
author=Kivy team
orientation=landscape</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Daisuke Saito.<br/>
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2 で生成しました。<br/>
    </p>
  </div>
</footer>
  </body>
</html>